(function(){}());function TippenPageBuilder(){if(navigator.onLine){pageBuilder();CurrentTime=Math.floor(Date.now());formTippen=document.getElementById("Tippen");dbRefCurrentGames=firebase.database().ref().child("spiele");dbRefCurrentGames=dbRefCurrentGames.orderByChild("timestamp");dbRefCurrentGames=dbRefCurrentGames.startAt(CurrentTime).limitToFirst(15);dbRefCurrentGames.on("value",function(a){CurrentGames=a.val();createformTippen(CurrentGames,CurrentTime)})}else{window.location="/offline.html"}makeReady()}function ErgebnisPageBuilder(){if(navigator.onLine){pageBuilder();formErgebnis=document.getElementById("Ergebnis");CurrentTime=Math.floor(Date.now());dbRefErgebnisGames=firebase.database().ref().child("spiele");dbRefErgebnisGames=dbRefErgebnisGames.orderByChild("timestamp");dbRefErgebnisGames=dbRefErgebnisGames.endAt(CurrentTime).limitToLast(20);dbRefErgebnisGames.on("value",function(a){ErgebnisGames=a.val();createformErgebnis(ErgebnisGames,CurrentTime)})}else{window.location="/offline.html"}}function AddGamesPageBuilder(){if(navigator.onLine){pageBuilder();tableGamesinDB=document.getElementById("GamesinDB");formNewGame=document.getElementById("NewGame");dbRefSpiele=firebase.database().ref().child("spiele");dbRefSpiele.on("value",function(a){allGames=a.val();AddGamesbuildingHTML(allGames)})}else{window.location="/offline.html"}makeReady()}function OfflinePageBuilder(){$("#footer").load("/inc/footer.html");futurecards=localStorage.getItem("futuregames");futuregamesdiv=document.getElementById("futureGames");futuregamesdiv.innerHTML=futurecards;cards=localStorage.getItem("pastgames");pastgamesdiv=document.getElementById("pastGames");pastgamesdiv.innerHTML=cards;document.getElementById("mainTable").innerHTML=localStorage.getItem("monthTable");document.getElementById("monthyTables").innerHTML=localStorage.getItem("monthyTables");document.getElementById("panicoDate").innerHTML=moment(localStorage.getItem("panicoDate")).format("LLLL")+" ("+moment(localStorage.getItem("panicoDate")).fromNow()+")";document.getElementById("monthDate").innerHTML=moment(localStorage.getItem("monthDate")).format("LLLL")+" ("+moment(localStorage.getItem("monthDate")).fromNow()+")";document.getElementById("tippsDate").innerHTML=moment(localStorage.getItem("tippsDate")).format("LLLL")+" ("+moment(localStorage.getItem("tippsDate")).fromNow()+")";makeReady();callMasonry("grid1","grid-item");callMasonry("grid2","grid-item");$(".modal-trigger").leanModal();$(".material-icons").hide();$(".collapsible").collapsible({accordion:false})}function ArchivPageBuilder(){if(navigator.onLine){pageBuilder()}else{window.location="/offline.html"}makeReady()}function TabellePageBuilder(){if(navigator.onLine){pageBuilder();mainTable=document.getElementById("mainTable");dbRefPlayers=firebase.database().ref().child("players");dbRefPlayers.on("value",function(a){allPlayersScores=a.val();tabelleBuilder(allPlayersScores)})}else{window.location="/offline.html"}makeReady()}function TippsPageBuilder(){if(navigator.onLine){pageBuilder();CurrentTime=Math.floor(Date.now());millisecs=60000;TimeBreak=CurrentTime-(160*millisecs);pastGames=document.getElementById("pastGames");futureGames=document.getElementById("futureGames");dbRefFutureGames=firebase.database().ref().child("spiele");dbRefFutureGames=dbRefFutureGames.orderByChild("timestamp");dbRefFutureGames=dbRefFutureGames.startAt(TimeBreak).limitToFirst(16);dbRefFutureGames.on("value",function(a){futureGamesDB=a.val();futureGamesBuilder(futureGamesDB,CurrentTime)});dbRefPastGames=firebase.database().ref().child("spiele");dbRefPastGames=dbRefPastGames.orderByChild("timestamp");dbRefPastGames=dbRefPastGames.endAt(TimeBreak).limitToLast(26);dbRefPastGames.on("value",function(a){pastGamesDB=a.val();pastGamesBuilder(pastGamesDB)})}else{window.location="/offline.html"}makeReady()}function notificationsPageBuilder(){if(navigator.onLine){pageBuilder();if(("showNotification" in ServiceWorkerRegistration.prototype)){console.log("Notifications are supported.");notificationIDhandling()}else{html="";html+='<span class="card-title">Notifications not supported</span>';html+="Notifications werden leider in diesem Browser nicht unterstützt. Auf iOS Geräten gibt es diese Option leider in keinem Browser.<br><br>Auf anderen Geräten sollten Chrome, Firefox oder Browser basierend auf diesen Systemen funktionieren.";document.getElementById("id").innerHTML=html}}makeReady()}function AddGamesbuildingHTML(c){formfields={mannschaft1:"text",mannschaft2:"text",wettbewerb:"text",land:"text",fortschritt:"text",art:"text",timestamp:"datetime",oldtimestamp:"datetime",bonuspunkte:"number",length:"multiple",hinspiel:"text",};var a="";for(var f in formfields){if(f=="length"){a+='<div class="input-field col s12"><select multiple id="length"><option value="" disabled selected>Choose Length</option><option value="90">90</option><option value="120">120</option><option value="11er">11er</option></select><label>Length</label></div>'}else{if(f=="oldtimestamp"){a+='<div class="input-field col s12 hide"><input type="'+formfields[f]+'" id="'+f+'" name="'+f+'" /><label for="'+f+'">'+f+"</label></div>"}else{if(f=="hinspiel"){a+='<div class="input-field col s12"><input class="autocomplete" type="'+formfields[f]+'" id="'+f+'" name="'+f+'" required/><label for="'+f+'">'+f+"</label></div>"}else{a+='<div class="input-field col s12 m6"><input class="autocomplete" type="'+formfields[f]+'" id="'+f+'" name="'+f+'" required/><label for="'+f+'">'+f+"</label></div>"}}}autoCompletes(f)}formNewGame.innerHTML=a;var l="<thead><tr>";for(var f in formfields){if(f=="oldtimestamp"){}else{l+='<th data-field="'+f+'">'+f+"</th>"}}l+="</tr></thead><tbody>";var b=sortingObject("timestamp",c);for(var f=0;f<b.length;f++){var e=b[f].key;var m=c[e];l+="<tr>";for(var d in formfields){if(d=="length"){lengthforTable=m[d];var h="";for(var k in lengthforTable){h+=lengthforTable[k]+"|"}h=h.substring(0,h.length-1);l+="<td>"+h+"</td>"}else{if(d=="timestamp"){l+="<td>"+new Date(m[d]).toLocaleString()+"</td>"}else{if(d=="oldtimestamp"){}else{l+="<td>"+m[d]+"</td>"}}}if(d=="hinspiel"){if(m.art=="Hinspiel"){console.log(e)}}}passID="'"+e+"'";l+='<td><input class="btn" name="edit" type="submit" value="Edit" onclick="editGames(allGames,'+passID+')" /></td>';l+='<td><input class="btn" name="deleteshow'+e+'" type="submit" value="Delete" id="deleteshow'+e+'" onclick="showDeleteButton('+passID+')" /><input class="btn red" style="display: none;" name="reallydelete'+e+'" id="reallydelete'+e+'" type="submit" value="Really?" onclick="deleteGame('+passID+')"/></td>';l+="</tr>";var g=[];g.push({ID:e})}l+="</tbody>";tableGamesinDB.innerHTML=l;makeReady()}function autoCompletes(a){var b=a;if(a){if(a.substr(0,10)==="mannschaft"){a="mannschaft"}}if(a=="hinspiel"){}else{dbResources=firebase.database().ref("resources/"+a);dbResources.on("value",function(c){dbResources=c.val();console.log(dbResources);$("input#"+b).autocomplete({data:dbResources})})}}function editGames(b,a){var e=[];for(var c in b[a].length){e.push(b[a].length[c])}console.log(e);document.getElementById("mannschaft1").value=b[a].mannschaft1;document.getElementById("mannschaft2").value=b[a].mannschaft2;document.getElementById("wettbewerb").value=b[a].wettbewerb;document.getElementById("fortschritt").value=b[a].fortschritt;document.getElementById("art").value=b[a].art;document.getElementById("timestamp").value=new Date(b[a].timestamp).toString();var d=a.substr(0,13);d=parseInt(d);document.getElementById("oldtimestamp").value=a;document.getElementById("bonuspunkte").value=b[a].bonuspunkte;document.getElementById("land").value=b[a].land;document.getElementById("length").value=e;Materialize.updateTextFields();$("#length").material_select()}function submitNewGame(){var e=document.getElementById("mannschaft1").value;var c=document.getElementById("mannschaft2").value;var r=document.getElementById("wettbewerb").value;var q=document.getElementById("fortschritt").value;var h=document.getElementById("art").value;var m=document.getElementById("timestamp").value;var o=document.getElementById("oldtimestamp").value;var s=document.getElementById("bonuspunkte").value;var b=document.getElementById("length");var g=document.getElementById("land").value;var f="{";for(var k=1;k<b.options.length;k++){if(b.options[k].selected){f+='"'+b.options[k].value+'":"'+b.options[k].value+'",'}}f=f.substring(0,f.length-1);f+="}";b=f;datevalue=Date.parse(m);if(o){console.log("Editing existing game");var l=o}else{var l=datevalue.toString()+e.replace(/\W+/g,"")+c.replace(/\W+/g,"")}var a='{  "'+l+'": {  "art": "'+h+'",        "bonuspunkte": '+s+',        "fortschritt": "'+q+'", "length":'+b+', "land":"'+g+'",        "mannschaft1": "'+e+'",        "mannschaft2": "'+c+'",    "timestamp": '+datevalue+',      "wettbewerb": "'+r+'"}}';var a=jQuery.parseJSON(a);var d=function(t){if(t){console.log("Synchronization failed")}else{console.log("Synchronization succeeded")}};dbRefSpiele.update(a,d)}function showDeleteButton(a){$("#deleteshow"+a).hide();$("#reallydelete"+a).show()}function deleteGame(a){dbRefRemoveLine=firebase.database().ref("spiele/"+a);dbRefRemoveLine.remove()}function changeBonusPoints(){}function createformTippen(a,b){formTippenfields={mannschaft1:"number",mannschaft2:"number",length:"select",winner:"select"};millisecs=60000;dbWettbewerb=firebase.database().ref();dbWettbewerb.on("value",function(c){dbPlayers=c.child("players").val();dbWettbewerb=c.child("resources/wettbewerb").val();dbMannschaft=c.child("resources/mannschaft").val();countPlayers=0;printedCards=0;var f=localStorage.getItem("username");cards='<div class="row">';cards+='<div class="col s12 m12"><div class="card"><div class="card-content"><p><label>Name</label><select id="player" required><option value="" disabled selected>Bitte auswählen</option>';for(var d in dbPlayers){cards+='<option value="'+d+'"';if(f==d){cards+="selected"}cards+=">"+d+"</option>";countPlayers+=1}cards+="</select></p></div></div></div>";cards+="</div>";cards+='<div  class="row grid">';var e=sortingObject("timestamp",a);for(var h=0;h<e.length;h++){var g=e[h].key;var q=a[g];var l=0;var r="";if(q.timestamp>b+14400*millisecs){continue}for(j in dbPlayers){if(dbPlayers[j][g]){l+=1;r+=j+", "}}r=r.substring(0,r.length-2);fortschritt=q.fortschritt;if(fortschritt=="Normal"){fortschritt=""}else{if(fortschritt.slice(-1)=="e"){fortschritt=fortschritt.substring(0,fortschritt.length-1)}}cards+='<div class="col s12 m6 grid-item"><div class = "card" style = "background-color:#fff" ><div class = "card-content" >';cards+='<span class="badge"><img src="'+dbWettbewerb[q.wettbewerb]+'" alt="'+q.wettbewerb+'" class="responsive-img" style="height:30px"/></span>';cards+='<p style="font-size:larger; font-weight:bold"><picture alt="Mannschaft1" class="responsive-img" style="height: 14px; margin-right: 7px;" ><source type="image/webp" srcset="'+dbMannschaft[q.mannschaft1]+'.webp"><img src="'+dbMannschaft[q.mannschaft1]+'.png" height= "14px" /></picture>'+q.mannschaft1+"</p>";cards+='<p style="font-size:larger; font-weight:bold"><picture alt="Mannschaft2" class="responsive-img" style="height: 14px; margin-right: 7px;" ><source type="image/webp" srcset="'+dbMannschaft[q.mannschaft2]+'.webp"><img src="'+dbMannschaft[q.mannschaft2]+'.png" height= "14px" /></picture>'+q.mannschaft2+"</p>";cards+='<p style="font-size:smaller; font-weight:inherit; color:#999">'+q.wettbewerb+" "+fortschritt+" "+q.art+'<a class="tooltipped" style="color:#999" data-position="bottom" data-delay="50" data-tooltip="'+moment(new Date(q.timestamp)).format("LLLL")+' Uhr"> '+moment(new Date(q.timestamp)).fromNow()+"</a></p>";cards+='<p style="font-size:smaller; font-weight:inherit; color:#999" id="'+g+'notesfield"></p>';if(l!=countPlayers){m1=q.mannschaft1;m2=q.mannschaft2;art=q.art;transuseID="'"+g+"'";transm1="'"+m1+"'";transm2="'"+m2+"'";transart="'"+art+"'";cards+='<div class="input-field col s6 m6"><input id="'+g+'M1" type="number" class="validate" onchange="changeWinnerSelect('+transuseID+","+transm1+","+transm2+","+transart+')"><label for="'+g+'M1">Heim</label></div>';cards+='<div class="input-field col s6 m6"><input id="'+g+'M2" type="number" class="validate" onchange="changeWinnerSelect('+transuseID+","+transm1+","+transm2+","+transart+')"><label for="'+g+'M2">Gast</label></div>';length=q.length;var m="";var k=0;for(var o in length){k+=1;m+='<option value="'+length[o]+'">'+length[o]+"</option>"}if(k>1){cards+='<div class="input-field col s6"><select id="'+g+'Length"><option value="" disabled selected>Länge</option>';cards+=m;cards+="</select></div>";cards+='<div class="input-field col s6"><select id="'+g+'Winner"><option value="" disabled selected>Sieger</option>';cards+='<option value="'+m1+'">'+m1+"</option>";cards+='<option value="'+m2+'">'+m2+"</option>";cards+="</select></div>"}}passID="'"+g+"'";if(l>0){cards+='<p style="font-size:smaller; font-weight:inherit; color:#999">Getippt von: '+r+"</p>"}else{cards+='<p style="font-size:smaller; font-weight:inherit; color:#999">Bisher noch keine Tipps</p>'}cards+="</div></div></div>";printedCards+=1;formTippen.innerHTML=cards}cards+="</div>";if(printedCards<1){cards='<div class="row">';cards+='<div class="col s12 m6 grid-item"><div class = "card" style = "background-color:#fff" ><div class = "card-content" >Keine Spiele  zu tippen </div></div></div>';cards+="</div>";document.getElementById("submitbutton").className+=" disabled"}formTippen.innerHTML=cards;makeReady();callMasonry()})}function submitTipps(s){var h=document.getElementById("player").value;var o=0;if(h){localStorage.setItem("username",h);dbRefPlayers=firebase.database().ref("players/"+h);var q=0;var m={};for(var k in s){q+=1;abgabeZeit=Math.floor(Date.now());if($("#"+k+"M1").length&&(abgabeZeit<=s[k]["timestamp"])){var g=document.getElementById(k+"M1").value;var e=document.getElementById(k+"M2").value;if(g&&e){var b='{  "scoreM1": '+g+',        "scoreM2": '+e;koGame=s[k]["length"];var a=0;for(var r in koGame){a+=1}if(a>1){var c=document.getElementById(k+"Length").value;var l=document.getElementById(k+"Winner").value;b+=',  "length":"'+c+'", "winner":"'+l+'"'}b+="}";var f=jQuery.parseJSON(b);m[k]=f;o+=1;var d=function(t){if(t){console.log("Synchronization failed");displayToast("Serverfehler","red")}else{console.log("Synchronization succeeded");if(o==1){document.getElementById("toast").innerHTML=o+" Spiel getippt"}else{document.getElementById("toast").innerHTML=o+" Spiele getippt"}}}}}}console.log(m);dbRefPlayers.update(m,d);displayToast("Stimmt alles?","green")}else{displayToast("Namen angeben!","red")}}function changeWinnerSelect(d,c,a,e){var b=document.getElementById(d+"Winner");console.log(c);if(b&&e=="Rückspiel"){firebase.database().ref("spiele/"+d).once("value").then(function(f){var g=f.val().hinspiel;console.log(g);firebase.database().ref("scores/"+g).once("value").then(function(k){var h=k.val().scoreM1;var l=k.val().scoreM2;console.log("Hinspiel: "+a+" "+h+":"+l+" "+c);document.getElementById(d+"notesfield").innerHTML="Hinspiel: "+a+" "+h+":"+l+" "+c;scoreMannschaft1=document.getElementById(d+"M1").value;scoreMannschaft2=document.getElementById(d+"M2").value;if(scoreMannschaft1&&scoreMannschaft2){if(scoreMannschaft1>scoreMannschaft2){b.value=c}else{if(scoreMannschaft1<scoreMannschaft2){b.value=a}else{if(scoreMannschaft1==scoreMannschaft2){if(l>h){b.value=c}else{if(l<h){b.value=a}else{if(l==h){if(scoreMannschaft2>l){b.value=a}else{if(scoreMannschaft2<l){b.value=c}}}}}}}}if((scoreMannschaft1==l)&&(scoreMannschaft2==h)){document.getElementById(d+"Length").value="11er"}else{if(document.getElementById(d+"Length").value=="11er"){document.getElementById(d+"Length").value="90"}}$("#"+d+"Length").material_select();$("#"+d+"Winner").material_select()}})})}else{if(b){scoreMannschaft1=document.getElementById(d+"M1").value;scoreMannschaft2=document.getElementById(d+"M2").value;if(scoreMannschaft1&&scoreMannschaft2){if(scoreMannschaft1>scoreMannschaft2){b.value=c}else{if(scoreMannschaft1<scoreMannschaft2){b.value=a}}if(scoreMannschaft1==scoreMannschaft2){document.getElementById(d+"Length").value="11er"}else{if(document.getElementById(d+"Length").value=="11er"){document.getElementById(d+"Length").value="90"}else{if((scoreMannschaft1>0||scoreMannschaft2>0)&&(document.getElementById(d+"Length").value=="")){console.log(document.getElementById(d+"Length").value);document.getElementById(d+"Length").value="90"}}}$("#"+d+"Length").material_select();$("#"+d+"Winner").material_select()}}}}function createformErgebnis(a,b){dbWettbewerb=firebase.database().ref();dbWettbewerb.on("value",function(d){dbPlayers=d.child("players").val();dbWettbewerb=d.child("resources/wettbewerb").val();dbMannschaft=d.child("resources/mannschaft").val();dbRefScoresCheck=d.child("scores").val();var c="";c+='<div class="row grid">';var e=sortingObject("timestamp",a);var k=4;var l=0;for(var g=0;g<e.length;g++){var f=e[g].key;var q=a[f];if(l==k){break}else{if(dbRefScoresCheck[f]){continue}}c+='<div class="col s12 m6 grid-item"><div class = "card" style = "background-color:#fff" ><div class = "card-content" >';c+='<span class="badge"><img src="'+dbWettbewerb[q.wettbewerb]+'" alt="'+q.wettbewerb+'" class="responsive-img" style="height:30px"/></span>';c+='<p style="font-size:larger; font-weight:bold"><img src="'+dbMannschaft[q.mannschaft1]+'" alt="Mannschaft1" class="circle responsive-img" style="height: 14px; margin-right: 7px;" />'+q.mannschaft1+"</p>";c+='<p style="font-size:larger; font-weight:bold"><img src="'+dbMannschaft[q.mannschaft2]+'" alt="Mannschaft1" class="circle responsive-img" style="height: 14px; margin-right: 7px;" />'+q.mannschaft2+"</p>";c+='<p style="font-size:smaller; font-weight:inherit; color:#999">'+q.wettbewerb+" "+q.fortschritt+" "+q.art+" am "+new Date(q.timestamp).toLocaleDateString()+" um "+new Date(q.timestamp).toLocaleTimeString()+" Uhr</p>";c+='<div class="input-field col s6 m6"><input id="'+f+'M1" type="number" class="validate"><label for="'+f+'M1">Heim</label></div>';c+='<div class="input-field col s6 m6"><input id="'+f+'M2" type="number" class="validate"><label for="'+f+'M2">Gast</label></div>';length=q.length;var m="";var h=0;for(var o in length){h+=1;m+='<option value="'+length[o]+'">'+length[o]+"</option>"}if(h>1){c+='<div class="input-field col s6"><select id="'+f+'Length"><option value="" disabled selected>Länge</option>';c+=m;c+="</select></div>";c+='<div class="input-field col s6"><select id="'+f+'Winner"><option value="" disabled selected>Sieger</option>';c+='<option value="'+q.mannschaft1+'">'+q.mannschaft1+"</option>";c+='<option value="'+q.mannschaft2+'">'+q.mannschaft2+"</option>";c+="</select></div>";c+='<div id="'+f+'bonuspunkte" value="'+q.bonuspunkte+'" class="hidden"></div>'}passID="'"+f+"'";c+='<p style="font-size:smaller; font-weight:inherit; color:#999">Bisher noch kein Ergebnis eingetragen</p>';c+="</div></div></div>";l+=1}if(l==0){c+='<div class="col s12 m6 grid-item"><div class = "card" style = "background-color:#fff" ><div class = "card-content" >Keine fehlenden Ergebnisse</div></div></div>';document.getElementById("submitbutton").className+=" disabled"}c+="</div>";formErgebnis.innerHTML=c;makeReady();callMasonry()})}function submitErgebnis(o){var m=0;var l={};for(var h in o){if($("#"+h+"M1").length){var g=document.getElementById(h+"M1").value;var e=document.getElementById(h+"M2").value;if(g&&e){console.log(h+" Ergebnis wurde eingetragen");var b='{  "scoreM1": '+g+',        "scoreM2": '+e;koGame=o[h]["length"];var a=0;for(var q in koGame){a+=1}if(a>1){var c=document.getElementById(h+"Length").value;var k=document.getElementById(h+"Winner").value;if(c==""||k==""){continue}b+=',  "length":"'+c+'", "winner":"'+k+'"';var r=document.getElementById(h+"bonuspunkte").getAttribute("value");calcPointsSpecial(h,g,e,c,k,r)}else{calcPoints(h,g,e)}b+="}";var f=jQuery.parseJSON(b);l[h]=f;m+=1;dbRefScores=firebase.database().ref("scores");var d=function(s){if(s){console.log("Synchronization failed");displayToast("Serverfehler","red")}else{console.log("Synchronization succeeded");if(m==1){document.getElementById("toast").innerHTML=m+" Ergebnis eingetragen"}else{document.getElementById("toast").innerHTML=m+" Ergebnisse eingetragen"}}}}}}dbRefScores.update(l,d);displayToast("Stimmt alles?","green")}function calcPoints(a,c,b){dbAllPlayers=firebase.database().ref().child("players");dbAllPlayers.once("value").then(function(e){dbPlayers=e.val();for(var h in dbPlayers){if(dbPlayers[h][a]){var l=dbPlayers[h];var k=l[a]["scoreM1"];var g=l[a]["scoreM2"];var d=0;var f='{  "'+a+'": {  "scoreM1": '+k+',        "scoreM2": '+g;if(k==c&&g==b){d+=2}if((k>g&&c>b)||(k<g&&c<b)||(k==g&&c==b)){d+=1}f+=',"totalpoints":'+d;f+="}}";var f=jQuery.parseJSON(f);dbRefPlayers=firebase.database().ref("players/"+h);dbRefPlayers.update(f)}else{console.log(h+" hat nicht getippt");var d=-1;var k=0;var g=0;var f='{  "'+a+'": {  "scoreM1": '+k+',        "scoreM2": '+g;if(k==c&&g==b){d+=2}if((k>g&&c>b)||(k<g&&c<b)||(k==g&&c==b)){d+=1}f+=',"totalpoints":'+d;f+=',"nontipp":'+true;f+="}}";var f=jQuery.parseJSON(f);console.log(f);dbRefPlayers=firebase.database().ref("players/"+h);dbRefPlayers.update(f)}}})}function calcPointsSpecial(d,f,e,c,b,a){dbAllPlayers=firebase.database().ref().child("players");dbRefSpiele=firebase.database().ref().child("spiele");dbAllPlayers.once("value").then(function(g){dbPlayers=g.val();console.log("submittedGameID:"+d);dbRefSpiele.once("value").then(function(k){dbSpiele=k.val();for(var l in dbPlayers){if(dbPlayers[l][d]){var m=dbPlayers[l];var t=m[d]["scoreM1"];var s=m[d]["scoreM2"];var h=m[d]["length"];var o=m[d]["winner"];var q=0;var r='{  "'+d+'": {  "scoreM1": '+t+',        "scoreM2": '+s;if(t==f&&s==e){q+=2}if((t>s&&f>e)||(t<s&&f<e)||(t==s&&f==e)){q+=1}if(h==c){q+=1}if(o==b){q+=Number(a)}r+=',  "length":"'+h+'", "winner":"'+o+'"';r+=',"totalpoints":'+q;r+="}}";var r=jQuery.parseJSON(r);console.log(l);console.log(r);dbRefPlayers=firebase.database().ref("players/"+l);dbRefPlayers.update(r)}else{winnerOption1=dbSpiele[d]["mannschaft1"];winnerOption2=dbSpiele[d]["mannschaft2"];var m=dbPlayers[l];var t=0;var s=0;var h="";if(Math.random()>0.5){var o=winnerOption1}else{var o=winnerOption2}var q=-1;var r='{  "'+d+'": {  "scoreM1": '+t+',        "scoreM2": '+s;if(t==f&&s==e){q+=2}if((t>s&&f>e)||(t<s&&f<e)||(t==s&&f==e)){q+=1}if(h==c){q+=1}console.log(o);console.log(b);if(o==b){console.log(a);q+=Number(a)}r+=',  "length":"'+h+'", "winner":"'+o+'"';r+=',"totalpoints":'+q;r+="}}";var r=jQuery.parseJSON(r);console.log(l+" - nicht getippt");console.log(r);dbRefPlayers=firebase.database().ref("players/"+l);dbRefPlayers.update(r)}}})})}function tabelleBuilder(a){month=1;onedayArray(a,24);monthTable(a,month);if(new Date()>new Date("2016-09-01")){month=0;monthTable(a,month)}}function monthTable(b,a){monthLabels=[0,"Januar","Februar","März","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"];if(new Date()>new Date("2017-08-15")){return}currentMonth=new Date().getMonth()+a;if(currentMonth<10){currentMonth="0"+currentMonth}currentMonth=new Date("2016-"+currentMonth+"-01T00:00:00+02:00");currentMonth=monthStartEnd(currentMonth);console.log(currentMonth[1]);dbRefCurrentMonthGames=firebase.database().ref().child("spiele");dbRefCurrentMonthGames=dbRefCurrentMonthGames.orderByChild("timestamp");dbRefCurrentMonthGames=dbRefCurrentMonthGames.startAt(currentMonth[0]).endAt(currentMonth[1]);dbRefCurrentMonthGames.on("value",function(c){CurrentMonthGames=c.val();label=monthLabels[new Date().getMonth()+a];calcMonthPoints(CurrentMonthGames,b,label)});dbPanicoTable=firebase.database().ref("table").child("panico");dbPanicoTable.on("value",function(c){dbPanicoTable=c.val();panicoHTML(b,dbPanicoTable)})}function calcMonthPoints(e,h,b){var d={};for(var g in h){var a=h[g];var f=0;for(var c in e){if(a[c]){if(a[c]["totalpoints"]>0||a[c]["totalpoints"]<0){f+=a[c]["totalpoints"]}}}d[g]=-f}dbRefTable=firebase.database().ref("table/month/"+b);dbRefTable.update(d);createSubtables()}function createSubtables(){sortedMonths=["Juli","Juni","Mai","April","März","Februar","Januar","Dezember","November","Oktober","September","August"];panicoPunkte={Juli:12,Juni:11,Mai:10,April:9,"März":8,Februar:7,Januar:6,Dezember:5,November:4,Oktober:3,September:2,August:1};dbRefTable=firebase.database().ref("table/month");dbRefTable.on("value",function(b){subtables=b.val();monthlytableHTML="";monthNumber=0;var g={};monthlytableHTML+=' <ul class="collapsible" data-collapsible="expandable" style="background-color:#eeeeee">';for(i in sortedMonths){singleSubtable=subtables[sortedMonths[i]];if(subtables[sortedMonths[i]]){monthNumber+=1;var k=[];for(p in singleSubtable){k.push({name:p,timestamp:singleSubtable[p],onedaypoints:subtables.oneday[p]})}var c=sortingObject("timestamp",k);if(monthNumber==1){monthlytableHTML+='<li><div class="collapsible-header active" style="font-weight: bold"><i class="material-icons">today</i>'+sortedMonths[i]+" (+"+panicoPunkte[sortedMonths[i]]+')</div> <div class="collapsible-body" style="padding: 20px; margin: 0px; display: block; background-color:#f5f5f5"> <table class="bordered highlight"> <tbody>';monthlytableHTML+="<tr><th>Platz</th><th>Name</th><th>Punke</th><th>24hrs</th></tr>"}else{monthlytableHTML+='<li><div class="collapsible-header" style="font-weight: bold"><i class="material-icons">history</i>'+sortedMonths[i]+" (+"+panicoPunkte[sortedMonths[i]]+')</div> <div class="collapsible-body" style="padding: 20px; margin: 0px; display: block; background-color:#f5f5f5"> <table class="bordered highlight"> <tbody>';monthlytableHTML+="<tr><th>Platz</th><th>Name</th><th>Punke</th></tr>"}var f=0;var h=0;for(var d=0;d<c.length;d++){var e=c[d].key;var l=k[e];var a=l.timestamp;if(h!=a){f+=1}if(monthNumber==2){g[l.name]=panicoCalc(f,panicoPunkte[sortedMonths[i]]);panicoMonth=sortedMonths[i]}if(localStorage.getItem("username")==l.name){monthlytableHTML+='<tr style="color: #3f51b5; font-weight: bold">'}else{monthlytableHTML+="<tr>"}monthlytableHTML+="<td>"+f+".</td>";monthlytableHTML+="<td>"+l.name+"</td>";monthlytableHTML+="<td>"+-a+"</td>";if(monthNumber==1){n=l.onedaypoints;monthlytableHTML+="<td>"+(n<=0?"":"+")+n+"</td>"}monthlytableHTML+="</tr>";h=a}monthlytableHTML+="</tbody> </table> </div> </li>"}}if(monthNumber==2){monthly2tableHTML=monthlytableHTML;monthly2tableHTML+="</ul>";localStorage.setItem("monthyTables",monthly2tableHTML);localStorage.setItem("monthDate",new Date())}monthlytableHTML+="</ul>";dbRefPanico=firebase.database().ref("table/panico/"+panicoMonth);dbRefPanico.update(g);document.getElementById("monthyTables").innerHTML=monthlytableHTML;$(".collapsible").collapsible({accordion:false})})}function panicoCalc(a,b){if(a==1){panicoPoints=b}else{if(a==2){panicoPoints=b*0.5}else{panicoPoints=0}}return panicoPoints}function panicoHTML(k,e){tableHTML='<table class="striped">';tableHTML+='<thead><tr><th data-field="platz">Platz</th><th data-field="name">Name</th><th data-field="points">Panico</th><th data-field="points">Punkte</th></tr></thead>';tableHTML+="<tbody>";var v=[];for(var c in k){var o=0;for(var f in e){o+=e[f][c]}var q=k[c];var d=0;for(var w in q){if(q[w]["totalpoints"]>0||q[w]["totalpoints"]<0){d+=q[w]["totalpoints"]}}v.push({name:c,timestamp:-o,normalpoints:d})}var b=sortingObject("timestamp",v);var l=0;var t=0;for(var h=0;h<b.length;h++){var g=b[h].key;var u=v[g];var a=-u.timestamp;var r=u.normalpoints;if(t!=a){l+=1}if(localStorage.getItem("username")==u.name){tableHTML+='<tr style="color: #3f51b5; font-weight: bold">'}else{tableHTML+="<tr>"}tableHTML+="<td>"+l+".</td>";tableHTML+="<td>"+u.name+"</td>";tableHTML+="<td>"+a+"</td>";tableHTML+="<td>"+r+"</td>";tableHTML+="</tr>";t=a}tableHTML+="</tbody></table>";mainTable.innerHTML=tableHTML;localStorage.setItem("monthTable",tableHTML);localStorage.setItem("panicoDate",new Date());makeReady()}function onedayArray(b,a){CurrentTime=Math.floor(Date.now());millisecs=60000;TimeBreak=CurrentTime-(a*60*millisecs);dbRefOnedayGames=firebase.database().ref().child("spiele");dbRefOnedayGames=dbRefOnedayGames.orderByChild("timestamp");dbRefOnedayGames=dbRefOnedayGames.startAt(TimeBreak).endAt(CurrentTime);dbRefOnedayGames.on("value",function(d){onedayGames=d.val();var h={};for(var g in b){var c=b[g];var f=0;var k=0;for(var e in onedayGames){if(c[e]){if(c[e]["totalpoints"]>0||c[e]["totalpoints"]<0){if(onedayGames[e].timestamp>TimeBreak){k+=c[e]["totalpoints"]}}}}h[g]=k}dbRefOnedayTable=firebase.database().ref("table/month/oneday");dbRefOnedayTable.update(h)})}function monthStartEnd(b){var b=new Date(b);var a=Math.floor(new Date(Date.UTC(b.getFullYear(),b.getMonth(),1)));var c=Math.floor(new Date(Date.UTC(b.getFullYear(),b.getMonth()+1,0,23,59,59)));return[a,c]}function pastGamesBuilder(b){var a=sortingReverseObject("timestamp",b);dbScores=firebase.database().ref().child("scores");dbResources=firebase.database().ref().child("resources");dbResources.once("value").then(function(c){dbWettbewerb=c.child("wettbewerb").val();dbMannschaft=c.child("mannschaft").val();dbScores.on("value",function(d){dbScores=d.val();dbPlayers=firebase.database().ref().child("players");dbPlayers.on("value",function(f){dbPlayers=f.val();cards="";var e=[];var h=0;var q=0;for(var g in dbPlayers){h+=1}for(var l=0;l<a.length;l++){var k=a[l].key;var y=b[k];var u=0;var s="<thead><tr>";var w="";var v="";var r="";var z="";var m=false;for(j in dbPlayers){if(localStorage.getItem("username")==j){addstyle="color: #3f51b5; font-weight: bold;"}else{addstyle=""}if(dbPlayers[j][k]){u+=1;s+="<th style='"+addstyle+"'>"+j+"</th>";w+='<td style="'+addstyle+'">'+dbPlayers[j][k].scoreM1+":"+dbPlayers[j][k].scoreM2+"</td>";if(dbPlayers[j][k].length==""){v+='<td style="'+addstyle+'font-size:smaller;">Non-Tipp</td>';m=true}else{v+='<td style="'+addstyle+'">'+dbPlayers[j][k].length+"</td>"}r+='<td style="'+addstyle+'font-size:smaller;">'+dbPlayers[j][k].winner+"</td>";n=dbPlayers[j][k].totalpoints;if(m==false&&dbPlayers[j][k].nontipp){nontippInfo=" (NT)"}else{nontippInfo=""}z+='<td style="'+addstyle+'border-top: 1px solid #d0d0d0">'+(n<=0?"":"+")+n+nontippInfo+"</td>"}}s+="</thead></tr>";if(u==h||CurrentTime>y.timestamp){cards+='<div class="col s12 m6 grid-item"><div class = "card" style = "background-color:#fff" ><div class = "card-content" >';cards+='<span class="badge"><img src="'+dbWettbewerb[y.wettbewerb]+'" alt="'+y.wettbewerb+'" class="responsive-img" style="height:30px"/></span>';cards+='<p style="font-size:larger; font-weight:bold"><picture alt="Mannschaft1" class="responsive-img" style="height: 14px; margin-right: 7px;" ><source type="image/webp" srcset="'+dbMannschaft[y.mannschaft1]+'.webp"><img src="'+dbMannschaft[y.mannschaft1]+'.png" height= "14px" /></picture>'+y.mannschaft1+"</p>";cards+='<p style="font-size:larger; font-weight:bold"><picture alt="Mannschaft2" class="responsive-img" style="height: 14px; margin-right: 7px;" ><source type="image/webp" srcset="'+dbMannschaft[y.mannschaft2]+'.webp"><img src="'+dbMannschaft[y.mannschaft2]+'.png" height= "14px" /></picture>'+y.mannschaft2+"</p>";cards+='<p style="font-size:smaller; font-weight:inherit; color:#999">'+y.wettbewerb+" "+y.fortschritt+" "+y.art+" am "+moment(new Date(y.timestamp)).format("LLLL")+" Uhr</p>";finalscores=false;if(dbScores[k]){finalscores=true;cards+='<div class="divider" style="margin-bottom: 2px;"></div>';cards+='<p class="center" style="font-size:larger; font-weight:bold">'+dbScores[k].scoreM1+":"+dbScores[k].scoreM2+"</p>";if(dbScores[k].length){if(dbScores[k].length=="11er"){displayLength="(11er)"}else{displayLength="("+dbScores[k].length+" mins)"}cards+='<p class="center" style="font-size:smaller; font-weight:inherit;">'+dbScores[k].winner+" "+displayLength+"</p>"}}cards+='<table class="centered" style="table-layout:fixed">';cards+=s;cards+="<tbody>";cards+="<tr>"+w+"</tr>";length=y.length;var o=0;for(var x in length){o+=1}if(o>1){cards+="<tr>"+v+"</tr>";cards+="<tr>"+r+"</tr>"}if(finalscores){cards+="<tr>"+z+"</tr>"}cards+="</tbody></table>";q+=1;cards+="</div></div></div>";pastGames.innerHTML=cards;localStorage.setItem("pastgames",cards);localStorage.setItem("tippsDate",new Date())}}callMasonry("grid2","grid-item");if(q<1){cards='<div class="col s12 m6 grid-item"><div class = "card" style = "background-color:#fff" ><div class = "card-content" >Keine alten Tipps anzuzeigen</div></div></div>';pastGames.innerHTML=cards}})})})}function futureGamesBuilder(b,c){var a=sortingObject("timestamp",b);dbScores=firebase.database().ref().child("scores");dbResources=firebase.database().ref().child("resources");dbResources.once("value").then(function(d){dbWettbewerb=d.child("wettbewerb").val();dbMannschaft=d.child("mannschaft").val();dbScores.on("value",function(e){dbScores=e.val();dbPlayers=firebase.database().ref().child("players");dbPlayers.on("value",function(g){futurecards="";var f=[];var k=0;dbPlayers=g.val();for(var h in dbPlayers){k+=1}for(var m=0;m<a.length;m++){var l=a[m].key;var y=b[l];var u=0;var s="<thead><tr>";var w="";var v="";var r="";var z="";var o=false;for(j in dbPlayers){if(localStorage.getItem("username")==j){addstyle="color: #3f51b5; font-weight: bold;"}else{addstyle=""}if(dbPlayers[j][l]){u+=1;s+="<th style='"+addstyle+"'>"+j+"</th>";w+='<td style="'+addstyle+'">'+dbPlayers[j][l].scoreM1+":"+dbPlayers[j][l].scoreM2+"</td>";if(dbPlayers[j][l].length==""){v+='<td style="'+addstyle+'font-size:smaller;">Non-Tipp</td>';o=true}else{v+='<td style="'+addstyle+'">'+dbPlayers[j][l].length+"</td>"}r+='<td style="'+addstyle+'font-size:smaller;">'+dbPlayers[j][l].winner+"</td>";n=dbPlayers[j][l].totalpoints;if(o==false&&dbPlayers[j][l].nontipp){nontippInfo=" (NT)"}else{nontippInfo=""}z+='<td style="'+addstyle+'border-top: 1px solid #d0d0d0">'+(n<=0?"":"+")+n+nontippInfo+"</td>"}}s+="</thead></tr>";if(u==k||c>y.timestamp){futurecards+='<div class="col s12 m6 grid-item"><div class = "card" style = "background-color:#fff" ><div class = "card-content" >';futurecards+='<span class="badge"><img src="'+dbWettbewerb[y.wettbewerb]+'" alt="'+y.wettbewerb+'" class="responsive-img" style="height:30px"/></span>';futurecards+='<p style="font-size:larger; font-weight:bold"><picture alt="Mannschaft1" class="responsive-img" style="height: 14px; margin-right: 7px;" ><source type="image/webp" srcset="'+dbMannschaft[y.mannschaft1]+'.webp"><img src="'+dbMannschaft[y.mannschaft1]+'.png" height= "14px" /></picture>'+y.mannschaft1+"</p>";futurecards+='<p style="font-size:larger; font-weight:bold"><picture alt="Mannschaft2" class="responsive-img" style="height: 14px; margin-right: 7px;" ><source type="image/webp" srcset="'+dbMannschaft[y.mannschaft2]+'.webp"><img src="'+dbMannschaft[y.mannschaft2]+'.png" height= "14px" /></picture>'+y.mannschaft2+"</p>";futurecards+='<p style="font-size:smaller; font-weight:inherit; color:#999">'+y.wettbewerb+" "+y.fortschritt+" "+y.art+'<a class="tooltipped" style="color:#999" data-position="bottom" data-delay="50" data-tooltip="'+moment(new Date(y.timestamp)).format("LLLL")+' Uhr"> '+moment(new Date(y.timestamp)).fromNow()+"</a></p>";finalscores=false;if(dbScores[l]){finalscores=true;futurecards+='<div class="divider" style="margin-bottom: 2px;"></div>';futurecards+='<p class="center" style="font-size:larger; font-weight:bold">'+dbScores[l].scoreM1+":"+dbScores[l].scoreM2+"</p>";if(dbScores[l].length){if(dbScores[l].length=="11er"){displayLength="(11er)"}else{displayLength="("+dbScores[l].length+" mins)"}futurecards+='<p class="center" style="font-size:smaller; font-weight:inherit;">'+dbScores[l].winner+" "+displayLength+"</p>"}}futurecards+='<table class="centered" style="table-layout:fixed">';futurecards+=s;futurecards+="<tbody>";futurecards+="<tr>"+w+"</tr>";length=y.length;var q=0;for(var x in length){q+=1}if(q>1){futurecards+="<tr>"+v+"</tr>";futurecards+="<tr>"+r+"</tr>"}if(finalscores){futurecards+="<tr>"+z+"</tr>"}futurecards+="</tbody></table>";futurecards+="</div></div></div>";futureGames.innerHTML=futurecards;localStorage.setItem("futuregames",futurecards);localStorage.setItem("tippsDate",new Date())}}callMasonry("grid1")})})})}function notifications(){messaging.onMessage(function(a){console.log(a)});messaging.onTokenRefresh(function(){messaging.getToken().then(function(a){var c=localStorage.getItem("username");var b=localStorage.getItem("devicename");console.log("Token refreshed.");notificationTokenServer(a,c,b)})})}function notificationSetup(){console.log("Requesting permission...");player=document.getElementById("player").value;devicename=document.getElementById("devicename").value;console.log(player);console.log(devicename);if(player==""||devicename==""){console.log("Values not provided")}else{localStorage.setItem("username",player);localStorage.setItem("devicename",devicename);messaging.requestPermission().then(function(){console.log("Notification permission granted.");return messaging.getToken()}).then(function(a){notificationTokenServer(a,player,devicename);notificationsSetting()})}}function notificationSignup(){dbWettbewerb=firebase.database().ref();dbWettbewerb.on("value",function(a){dbPlayers=a.child("players").val();var c=localStorage.getItem("username");cards='<div class="row">';cards+='<div class="col s12 m12"><div class="card"><div class="card-content"><p><label>Name</label><select id="player" required><option value="" disabled selected>Bitte auswählen</option>';for(var b in dbPlayers){cards+='<option value="'+b+'"';if(c==b){cards+="selected"}cards+=">"+b+"</option>"}cards+="</select></p>";cards+='<div class="input-field col s12"><input type="text" id="devicename" name="devicename" /><label for="devicename">Name des Geräts</label></div>';cards+='<input class="btn" name="Notifications erhalten" type="submit" value="Notifications erhalten" onclick="notificationSetup()" />';cards+="</div></div></div></div>";document.getElementById("signupform").innerHTML=cards;makeReady()})}function notificationsSetting(){var a=localStorage.getItem("username");dbRefNotifications=firebase.database().ref("notifications/"+a);dbRefNotifications.on("value",function(b){notificationDevices=b.val();html="";html+='<span class="card-title">Settings</span>';html+="<table><tbody>";for(var c in notificationDevices){html+="<tr>";html+="<td>"+c+"</td>";passID="'"+c+"'";html+='<td><input class="btn" name="deleteshow'+c+'" type="submit" value="Delete" id="deleteshow'+c+'" onclick="showDeleteButton('+passID+')" /><input class="btn red" style="display: none;" name="reallydelete'+c+'" id="reallydelete'+c+'" type="submit" value="Really?" onclick="deleteDevice('+passID+')"/></td>';html+="</tr>"}html+="</tbody></table>";document.getElementById("id").innerHTML=html})}function deleteDevice(a){console.log(a);var b=localStorage.getItem("username");dbRefRemoveLine=firebase.database().ref("notifications/"+b+"/"+a);dbRefRemoveLine.remove()}function notificationIDhandling(){messaging.getToken().then(function(a){var c=localStorage.getItem("username");var b=localStorage.getItem("devicename");if(a&&c&&b){notificationTokenServer(a,c,b);notificationsSetting()}else{console.log("No Instance ID token available. Request permission to generate one.");notificationSignup()}});messaging.onTokenRefresh(function(){messaging.getToken().then(function(a){var c=localStorage.getItem("username");var b=localStorage.getItem("devicename");console.log("Token refreshed.");notificationTokenServer(a,c,b)})})}function notificationTokenServer(b,a,d){console.log(b);dbRefNotifications=firebase.database().ref("notifications/"+a);newTokenEntry='{"'+d+'":"'+b+'"}';var c=jQuery.parseJSON(newTokenEntry);console.log(c);dbRefNotifications.update(c)}function sortingObject(b,c){var d=[];for(var a in c){d.push({key:a,timestamp:c[a].timestamp})}d.sort(function(e,f){return e.timestamp-f.timestamp});return(d)}function sortingReverseObject(b,c){var d=[];for(var a in c){d.push({key:a,timestamp:c[a].timestamp})}d.sort(function(e,f){return f.timestamp-e.timestamp});return(d)}function displayToast(b,a){Materialize.toast('<span id="toast">'+b+"</span>",8000,a)}function pageBuilder(){$("#navigation").load("/inc/navigation.html");$("#footer").load("/inc/footer.html");makeReady();var a={apiKey:"AIzaSyB2ycmW4sCSMm6py_NGdjtE77CGFM2PvGQ",authDomain:"project-985851437142041413.firebaseapp.com",databaseURL:"https://project-985851437142041413.firebaseio.com",storageBucket:"project-985851437142041413.appspot.com",messagingSenderId:"76547521231"};firebase.initializeApp(a);messaging=firebase.messaging();notifications();if(navigator.serviceWorker){navigator.serviceWorker.register("/sw.js").then(function(b){console.log("ServiceWorker registration successful with scope:",b.scope)})}}function makeReady(){$("select").material_select()}function sideNavAcitvation(){$(".button-collapse").sideNav()}function callMasonry(a,b,c){if(a){a="."+a}else{a=".grid"}if(b){b="."+b}else{b=".grid-item"}if(c){}else{c="masonry"}$(a).isotope({itemSelector:b,layoutMode:c});$(".tooltipped").tooltip({delay:50})}function setCookie(b,f,c){var e=new Date();e.setTime(e.getTime()+(c*24*60*60*1000));var a="expires="+e.toUTCString();document.cookie=b+"="+f+"; "+a}function getCookie(d){var b=d+"=";var a=document.cookie.split(";");for(var e=0;e<a.length;e++){var f=a[e];while(f.charAt(0)==" "){f=f.substring(1)}if(f.indexOf(b)==0){return f.substring(b.length,f.length)}}return""}function getResources(){var a={apiKey:"AIzaSyB2ycmW4sCSMm6py_NGdjtE77CGFM2PvGQ",authDomain:"project-985851437142041413.firebaseapp.com",databaseURL:"https://project-985851437142041413.firebaseio.com",storageBucket:"project-985851437142041413.appspot.com",};firebase.initializeApp(a);dbResourcesRef=firebase.database().ref("resources/mannschaft");dbResourcesRef.once("value").then(function(b){dbResources=b.val();html="";newurldata={};for(var c in dbResources){html+="/img/clubs/"+dbResources[c].slice(46).slice(0,-4)+"<br>";newurldata[c]="/img/clubs/"+dbResources[c].slice(46).slice(0,-4)}console.log(newurldata);document.getElementById("ausgabe").innerHTML=html})}function importJSON(){var a={apiKey:"AIzaSyB2ycmW4sCSMm6py_NGdjtE77CGFM2PvGQ",authDomain:"project-985851437142041413.firebaseapp.com",databaseURL:"https://project-985851437142041413.firebaseio.com",storageBucket:"project-985851437142041413.appspot.com",};firebase.initializeApp(a);dbRefSpiele=firebase.database().ref().child("spiele");entries={};console.log(entries);dbRefSpiele.update(entries)}function timezonefix(){var a={apiKey:"AIzaSyB2ycmW4sCSMm6py_NGdjtE77CGFM2PvGQ",authDomain:"project-985851437142041413.firebaseapp.com",databaseURL:"https://project-985851437142041413.firebaseio.com",storageBucket:"project-985851437142041413.appspot.com",};firebase.initializeApp(a);CurrentTime=Math.floor(Date.now());millisecs=60000;TimeBreak=CurrentTime-(160*millisecs);var b="";dbRefWintertime=firebase.database().ref().child("spiele");dbRefWintertime=dbRefWintertime.orderByChild("timestamp");dbRefWintertime=dbRefWintertime.endAt(1490493600000);dbRefWintertime.on("value",function(c){winterGames=c.val();var d={};d.timeZone="Europe/Amsterdam";d.timeZoneName="short";for(var e in winterGames){oldtime=winterGames[e]["timestamp"];newtime=oldtime+(60*millisecs);b+=new Date(oldtime).toLocaleString("de-DE",d)+" | "+new Date(newtime).toLocaleString()+"<br>"}document.getElementById("ausgabe").innerHTML=b})}if(("standalone" in window.navigator)&&window.navigator.standalone){var noddy,remotes=false;document.addEventListener("click",function(b){noddy=b.target;while(noddy.nodeName!=="A"&&noddy.nodeName!=="HTML"){noddy=noddy.parentNode}if("href" in noddy&&noddy.href.indexOf("http")!==-1&&(noddy.href.indexOf(document.location.host)!==-1||remotes)){b.preventDefault();document.location.href=noddy.href}},false)};